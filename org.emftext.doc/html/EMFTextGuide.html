<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title></title> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<!-- html --> 
<meta name="src" content="EMFTextGuide.tex"> 
<meta name="date" content="2010-08-09 17:44:00"> 
<link rel="stylesheet" type="text/css" href="EMFTextGuide.css"> 
</head><body 
>
  <div class="titlepage">
                                                                                     

                                                                                     
                                                                                     

                                                                                     
<!--l. 48--><p class="indent" >
                                                                                     

                                                                                     

<!--l. 55--><p class="noindent" ><img 
src="../latex/figures/EMFTextLogo.png" alt="PIC"  
>
<!--l. 61--><p class="noindent" ><span 
class="phvr8t-x-x-400">User Guide</span>
                                                                                     <div class="flushright" 
>
<!--l. 66--><p class="noindent" > 
<span 
class="aer12-">August 9, 2010</span></div>
                                                                                     

                                                                                     
  </div>
                                                                                     

                                                                                     
                                                                                     

                                                                                     
                                                                                     

                                                                                     
                                                                                     

                                                                                     
  <h2 class="likechapterHead"><a 
 id="x1-1000"></a>Contents</h2>
  <div class="tableofcontents">
  <span class="chapterToc" >1&#x00A0;&#x00A0;<a 
href="#x1-20001" id="QQ2-1-2">Overview</a></span>
<br />  <span class="chapterToc" >2&#x00A0;&#x00A0;<a 
href="#x1-30002" id="QQ2-1-3">Development Process</a></span>
<br />  &#x00A0;<span class="sectionToc" >2.1&#x00A0;&#x00A0;<a 
href="#x1-40002.1" id="QQ2-1-4">Creating a metamodel</a></span>
<br />  &#x00A0;<span class="sectionToc" >2.2&#x00A0;&#x00A0;<a 
href="#x1-50002.2" id="QQ2-1-5">Specifying Concrete Syntax</a></span>
<br />  &#x00A0;<span class="sectionToc" >2.3&#x00A0;&#x00A0;<a 
href="#x1-60002.3" id="QQ2-1-6">Generate Resource Plug-ins</a></span>
<br />  &#x00A0;<span class="sectionToc" >2.4&#x00A0;&#x00A0;<a 
href="#x1-70002.4" id="QQ2-1-7">Customize DSL</a></span>
<br />  <span class="chapterToc" >3&#x00A0;&#x00A0;<a 
href="#x1-80003" id="QQ2-1-8">Concrete Syntax Specification Language (CS)</a></span>
<br />  &#x00A0;<span class="sectionToc" >3.1&#x00A0;&#x00A0;<a 
href="#x1-90003.1" id="QQ2-1-9">Configuration Block</a></span>
<br />  &#x00A0;&#x00A0;<span class="subsectionToc" >3.1.1&#x00A0;&#x00A0;<a 
href="#x1-100003.1.1" id="QQ2-1-10">Required General Information</a></span>
<br />  &#x00A0;&#x00A0;<span class="subsectionToc" >3.1.2&#x00A0;&#x00A0;<a 
href="#x1-110003.1.2" id="QQ2-1-11">Importing other Models and Syntaxes</a></span>
  </div>
                                                                                     

                                                                                     
                                                                                     

                                                                                     
                                                                                     

                                                                                     
                                                                                     

                                                                                     
  <h2 class="chapterHead"><span class="titlemark">1</span>&#x00A0;&#x00A0;<a 
 id="x1-20001"></a>Overview</h2>
<!--l. 3--><p class="noindent" >EMFText is a tool which allows to define a textual syntax for Ecore based metamodels. From a
specification of this syntax, EMFText generates components to load, edit and store model
instances. The syntax is specified by a so called concrete syntax specification which are
stored in files with the suffix <span 
class="ul9r8t-x-x-95">.cs</span>. A <span 
class="ul9r8t-x-x-95">cs </span>specification is directly related to one or more
Ecore metamodel(s) which implicitly predefine a &#8221;grammar skeleton&#8221;. Figure&#x00A0;<span 
class="aebx-10x-x-109">??</span> gives
an overview on how the generator part of EMFText works and which components are
generated.
<!--l. 12--><p class="indent" >  <span 
class="aebx-10x-x-109">TODO Insert figure emftext_schema.gif.</span>
<!--l. 14--><p class="indent" >  Through combining metamodel and <span 
class="ul9r8t-x-x-95">cs </span>specification, EMFText derives a context-free
grammar and exports it as an Another Tool for Language Recognition (ANTLR)&#x00A0;<span class="cite">[<span 
class="aebx-10x-x-109">?</span>]</span>
parser specification. This specification contains annotated semantic actions which
perform the instantiation of models. EMFText then transparently delegates
parser<span class="footnote-mark"><a 
href="EMFTextGuide2.html#fn1x1"><sup class="textsuperscript">1</sup></a></span><a 
 id="x1-2001f1"></a>  and
lexer<span class="footnote-mark"><a 
href="EMFTextGuide3.html#fn2x1"><sup class="textsuperscript">2</sup></a></span><a 
 id="x1-2002f2"></a> 
generation to ANTLR by passing the generated grammar file. Since ANTLR does not cover the whole
class of context-free grammars one can not guarantee the generation of a working parser for arbitrary
cases. However, in most cases generation is sufficient.
<!--l. 25--><p class="indent" >  While parsers are used to load model instances from textual representations a printer is needed to
do the inverse (e.g., to print an in-memory model) back to a textual representation. The printed
results can then again be parsed by the corresponding parser. Both instances (printed and loaded)
are be equal. Furthermore, printers produce a formatted and human-readable output. The EMFText
built-in printer generator achieves these goals by interpreting the <span 
class="ul9r8t-x-x-95">cs </span>file and the derived grammar.
Also, <span 
class="ul9r8t-x-x-95">cs </span>specifications can be enriched by special operators to indicate that on a specific position
white-spaces or newlines have to be printed. Additionally, it uses information about literals (e.g.,
keywords) in defined languages which are removed from model instances. As for parser generation,
EMFText does not guarantee that printer generation works for arbitrary cases but mostly it is be a
convenient solution.
<!--l. 39--><p class="indent" >  EMFText also generates a set of resolvers. Resolvers convert parsed token strings to an adequate
representation in the metamodel instance.
<!--l. 42--><p class="indent" >  TokenResolvers implement a mapping from the string value of a specific token to a native Java
type (e.g., boolean, int, String etc.). In the standard implementation TokenResolvers can
automatically remove and add (printing) pre- and suffixes. The conversion to native java
data types is done by delegation to the corresponding Java type conversion functions. For
example, <span 
class="ul9r8t-x-x-95">Integer.parseInt("42") </span>results in an int valued <span 
class="ul9r8t-x-x-95">42</span>. Since this behavior is only
desired for concrete syntaxes mirroring exactly (or at least partially) the Java syntax for
primitive types, users are expected to implement more adequate mapping functions as
needed.
<!--l. 51--><p class="indent" >  Resolvements depending on context are meant to be realised by implementing ReferenceResolvers.
                                                                                     

                                                                                     
For these only stubs are generated. While TokenResolvers are directly invoked by parsers,
ReferenceResolvers are triggered on demand later by EMF&#8217;s proxy resolution mechanism. An
additional feature is the evaluation of eventually annotated Object Constraint Language (OCL)&#x00A0;<span class="cite">[<span 
class="aebx-10x-x-109">?</span>]</span>
constraints. With OCL, consistency conditions can be declared on the metamodel to further improve
quality of EMFText based developments.
                                                                                     

                                                                                     
                                                                                     

                                                                                     
<!--l. 1--><p class="indent" >
                                                                                     

                                                                                     
  <h2 class="chapterHead"><span class="titlemark">2</span>&#x00A0;&#x00A0;<a 
 id="x1-30002"></a>Development Process</h2>
<!--l. 3--><p class="noindent" >Creating parsers, printers and editors with EMFText is easy! It involves some necessary steps which
are roughly depicted by the activity diagram in Fig.&#x00A0;<span 
class="aebx-10x-x-109">??</span>.
<!--l. 7--><p class="indent" >  <span 
class="aebx-10x-x-109">TODO Insert figure emftext_process.png</span>
  <h3 class="sectionHead"><span class="titlemark">2.1</span>&#x00A0;&#x00A0;<a 
 id="x1-40002.1"></a>Creating a metamodel</h3>
<!--l. 11--><p class="noindent" >The starting point usually is the <span 
class="aesl-10x-x-109">Ecore model</span>. It serves as abstract syntax and as a skeleton for
concrete syntax. The model can be a graph or tree definition. Although Ecore models are specified as
XML files, it is recommended to use the Ecore model editor or a graphical editor (e.g., the Ecore
Tools). Additionally, a unique namespace (property NS URI in the .ecore file) for the models as well
as a package name needs to be specified. To enable EMFText to use models at runtime, a model
plug-in must be generated. For this, EMF provides a <span 
class="aesl-10x-x-109">generation metamodel </span>(GenModel) allowing to
enrich Ecore models with specific information for code generation. The EMF Model wizard facilitates
the creation of GenModels.
<!--l. 21--><p class="indent" >  The next step is to define the base package name which will be the common prefix for
all subsequently generated Java packages. After finishing configuration, the <span 
class="aesl-10x-x-109">EMF model</span>
<span 
class="aesl-10x-x-109">plug-in </span>is ready to be generated. EMFText will later use these classes to construct a model
instance.
<!--l. 26--><p class="noindent" >
  <h3 class="sectionHead"><span class="titlemark">2.2</span>&#x00A0;&#x00A0;<a 
 id="x1-50002.2"></a>Specifying Concrete Syntax</h3>
<!--l. 28--><p class="noindent" >After defining a metamodel, we can start specifying our <span 
class="aesl-10x-x-109">concrete syntax</span>. As a starting point,
EMFText provides a syntax generator that can automatically create a concrete-syntax specification
using HUTN (Human-Useable Textual Notation) from the metamodel. To manually specify the
concrete syntax, a textual specification has to be written, which has the ending <span 
class="ul9r8t-x-x-95">cs </span>(from <span 
class="ul9r8t-x-x-95">c</span>oncrete
<span 
class="ul9r8t-x-x-95">s</span>yntax).
<!--l. 35--><p class="indent" >  It consists of four sections: In the first part, a unique name refers to the syntax as a specific
resource type. Furthermore, the metamodel, whose textual syntax shall be defined, has to be
referenced by its unique namespace URI and a start symbol must be selected from the model
elements. In the second part, productions from other concrete syntax specifications can be imported.
This is especially useful if the metamodel is compositionally structured, e.g. reuses large parts from
other models which have an already specified concrete syntax. The third part allows for specifying
token types as it is usual for parser generators, but in contrast, EMFText also allows to leave
them out: If no token definitions are given, default rules are used. Another specialty for
token definitions are optional pre- and suffixes which are transparently removed (after
parsing) and added (before printing) by the generated token resolvers. And last but not
least, EBNF-like productions have to be defined for each non-abstract model element
reachable from the start symbol. They have to be defined with respect to the attributes
and references of the model element and thus do not contain nonterminals in the classic
sense.
                                                                                     

                                                                                     
<!--l. 52--><p class="noindent" >
  <h3 class="sectionHead"><span class="titlemark">2.3</span>&#x00A0;&#x00A0;<a 
 id="x1-60002.3"></a>Generate Resource Plug-ins</h3>
<!--l. 54--><p class="noindent" >The context menu on concrete syntax specification files offers an item to generate the actual
<span 
class="aesl-10x-x-109">resource plug-in </span>which contains the parser, printer and the editor for the language. In an
optional last step, the generated token resolvers and the printer can be tailored to specific
needs.
<!--l. 59--><p class="noindent" >
  <h3 class="sectionHead"><span class="titlemark">2.4</span>&#x00A0;&#x00A0;<a 
 id="x1-70002.4"></a>Customize DSL</h3>
<!--l. 61--><p class="noindent" ><span 
class="aebx-10x-x-109">TODO Add content</span>
                                                                                     

                                                                                     
                                                                                     

                                                                                     
<!--l. 1--><p class="indent" >
                                                                                     

                                                                                     
  <h2 class="chapterHead"><span class="titlemark">3</span>&#x00A0;&#x00A0;<a 
 id="x1-80003"></a>Concrete Syntax Specification Language (CS)</h2>
<!--l. 3--><p class="noindent" >An EMFText syntax specification must be contained in a file with the extension <span 
class="ul9r8t-x-x-95">.cs </span>and consist of
four main blocks:
     <ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-8002x1">A  mandatory  configuration  block,  which  specifies  the  name  of  the  syntax  (i.e.,  the
     file  extension),  the  generator  model  where  to  find  the  metaclasses  and  the  root
     metaclass (start symbol). Optionally other syntaxes and metamodels can be imported
     and generation options can be specified.
     </li>
     <li 
  class="enumerate" id="x1-8004x2">An (optional) <span 
class="ul9r8t-x-x-95">TOKEN </span>section. Here, tokens for the lexical analyser can be specified.
     </li>
     <li 
  class="enumerate" id="x1-8006x3">An (optional) <span 
class="ul9r8t-x-x-95">TOKENSTYLE </span>section. Here, the default style (i.e., color and font style) for
     tokens and keywords can be specified.
     </li>
     <li 
  class="enumerate" id="x1-8008x4">A <span 
class="ul9r8t-x-x-95">RULES </span>section, which defines the syntax for concrete metaclasses.</li></ol>
<!--l. 20--><p class="indent" >  In the following sections, these four main blocks will be explained in more detail.
  <h3 class="sectionHead"><span class="titlemark">3.1</span>&#x00A0;&#x00A0;<a 
 id="x1-90003.1"></a>Configuration Block</h3>
<!--l. 25--><p class="noindent" >
  <h4 class="subsectionHead"><span class="titlemark">3.1.1</span>&#x00A0;&#x00A0;<a 
 id="x1-100003.1.1"></a>Required General Information</h4>
<!--l. 27--><p class="noindent" >The first required piece of information, is the file extension that shall be used for the files will contain
your models:
  <!--l. 30-->
  <div class="lstlisting" id="listing-1"><span class="label"><a 
 id="x1-10001r1"></a></span><span 
class="ul9r8t-x-x-95">SYNTAXDEF</span><span 
class="ul9r8t-x-x-95">&#x00A0;</span><span 
class="ul9r8t-x-x-95">yourFileExtension</span>
  
  </div>
<!--l. 34--><p class="indent" >  Note: The file extension must not contain the dot character.
<!--l. 36--><p class="indent" >  Second, EMFText needs to know the EMF generator model (<span 
class="ul9r8t-x-x-95">.genmodel</span>) that contains the meta
classes for which the syntax will be used. EMFText does use the generator model rather than the
Ecore model, because it requires information about the code generated from the Ecore model (e.g.,
the fully qualified names of the metaclasses). The genmodel is found using its namespace
URI:
  <!--l. 43-->
  <div class="lstlisting" id="listing-2"><span class="label"><a 
 id="x1-10002r1"></a></span><span 
class="ul9r8t-x-x-95">FOR</span><span 
class="ul9r8t-x-x-95">&#x00A0;</span><span 
class="ul9r8t-x-x-95"><</span><span 
class="ul9r8t-x-x-95">yourGenModelURI</span><span 
class="ul9r8t-x-x-95">></span>
  
  </div>
<!--l. 47--><p class="indent" >  To find the generator model with the given namespace URI, EMFText uses the EMF generator
                                                                                     

                                                                                     
model registry. Also, EMFText looks for a <span 
class="ul9r8t-x-x-95">.genmodel </span>file, which has the same name as the syntax
definition. For example, if the syntax specification is contained in a file <span 
class="ul9r8t-x-x-95">yourdsl.cs</span>, EMFText looks
for a file called <span 
class="ul9r8t-x-x-95">yourdsl.genmodel </span>in the same folder.
<!--l. 53--><p class="indent" >  Optionally, a second parameter (<span 
class="ul9r8t-x-x-95">yourGenmodelLocation</span>) can be given:
  <!--l. 55-->
  <div class="lstlisting" id="listing-3"><span class="label"><a 
 id="x1-10003r1"></a></span><span 
class="ul9r8t-x-x-95">FOR</span><span 
class="ul9r8t-x-x-95">&#x00A0;</span><span 
class="ul9r8t-x-x-95"><</span><span 
class="ul9r8t-x-x-95">yourGenModelURI</span><span 
class="ul9r8t-x-x-95">></span><span 
class="ul9r8t-x-x-95">&#x00A0;</span><span 
class="ul9r8t-x-x-95"><</span><span 
class="ul9r8t-x-x-95">yourGenmodelLocation</span><span 
class="ul9r8t-x-x-95">></span>
  
  </div>
<!--l. 59--><p class="indent" >  This (second) parameter is only required, if the generator model is not registered in the generator
model registry, or if the name of the syntax definition (without the file extension) is different from the
generator model file name. In both cases a relative or absolute URI can be given to point to the
generator model.
<!--l. 65--><p class="indent" >  Third, the root element (start symbol) must be given. The root element must be a metaclass from
the metamodel:
  <!--l. 68-->
  <div class="lstlisting" id="listing-4"><span class="label"><a 
 id="x1-10004r1"></a></span><span 
class="ul9r8t-x-x-95">START</span><span 
class="ul9r8t-x-x-95">&#x00A0;</span><span 
class="ul9r8t-x-x-95">YourRootMetaClassName</span>
  
  </div>
<!--l. 72--><p class="indent" >  A CS specification can also have multiple root elements, which must be separated by a
comma:
  <!--l. 75-->
  <div class="lstlisting" id="listing-5"><span class="label"><a 
 id="x1-10005r1"></a></span><span 
class="ul9r8t-x-x-95">START</span><span 
class="ul9r8t-x-x-95">&#x00A0;</span><span 
class="ul9r8t-x-x-95">RootMetaClass1</span><span 
class="ul9r8t-x-x-95">,</span><span 
class="ul9r8t-x-x-95">&#x00A0;</span><span 
class="ul9r8t-x-x-95">RootMetaClass2</span><span 
class="ul9r8t-x-x-95">,</span><span 
class="ul9r8t-x-x-95">&#x00A0;</span><span 
class="ul9r8t-x-x-95">RootMetaClass3</span>
  
  </div>
<!--l. 79--><p class="indent" >  Altogether a typical header for a <span 
class="ul9r8t-x-x-95">.cs </span>file looks something like:
  <!--l. 81-->
  <div class="lstlisting" id="listing-6"><span class="label"><a 
 id="x1-10006r1"></a></span><span 
class="ul9r8t-x-x-95">SYNTAXDEF</span><span 
class="ul9r8t-x-x-95">&#x00A0;</span><span 
class="ul9r8t-x-x-95">yourFileExtension</span><span 
class="ul9r8t-x-x-95">&#x00A0;</span><br /><span class="label"><a 
 id="x1-10007r2"></a></span><span 
class="ul9r8t-x-x-95">FOR</span><span 
class="ul9r8t-x-x-95">&#x00A0;</span><span 
class="ul9r8t-x-x-95"><</span><span 
class="ul9r8t-x-x-95">yourGenModelURI</span><span 
class="ul9r8t-x-x-95">></span><span 
class="ul9r8t-x-x-95">&#x00A0;</span><span 
class="ul9r8t-x-x-95"><</span><span 
class="ul9r8t-x-x-95">yourGenmodelLocations</span><span 
class="ul9r8t-x-x-95">></span><span 
class="ul9r8t-x-x-95">&#x00A0;</span><br /><span class="label"><a 
 id="x1-10008r3"></a></span><span 
class="ul9r8t-x-x-95">START</span><span 
class="ul9r8t-x-x-95">&#x00A0;</span><span 
class="ul9r8t-x-x-95">YourRootMetaClassName</span>
  
  </div>
<!--l. 87--><p class="noindent" >
  <h4 class="subsectionHead"><span class="titlemark">3.1.2</span>&#x00A0;&#x00A0;<a 
 id="x1-110003.1.2"></a>Importing other Models and Syntaxes</h4>
<!--l. 89--><p class="noindent" >Models and syntaxes can be imported in a dedicated import section, which must follow after the start
symbols:
  <!--l. 92-->
  <div class="lstlisting" id="listing-7"><span class="label"><a 
 id="x1-11001r1"></a></span><span 
class="ul9r8t-x-x-95">IMPORTS</span><span 
class="ul9r8t-x-x-95">&#x00A0;</span><span 
class="ul9r8t-x-x-95">{</span><span 
class="ul9r8t-x-x-95">&#x00A0;</span><br /><span class="label"><a 
 id="x1-11002r2"></a></span><span 
class="ul9r8t-x-x-95">&#x00A0;</span><span 
class="ul9r8t-x-x-95">&#x00A0;</span><span 
class="ul9r8t-x-x-95">&#x00A0;</span><span 
class="ul9r8t-x-x-95">&#x00A0;</span><span 
class="ul9r8t-x-x-95">//</span><span 
class="ul9r8t-x-x-95">&#x00A0;</span><span 
class="ul9r8t-x-x-95">imports</span><span 
class="ul9r8t-x-x-95">&#x00A0;</span><span 
class="ul9r8t-x-x-95">go</span><span 
class="ul9r8t-x-x-95">&#x00A0;</span><span 
class="ul9r8t-x-x-95">here</span><span 
class="ul9r8t-x-x-95">&#x00A0;</span><br /><span class="label"><a 
 id="x1-11003r3"></a></span><span 
class="ul9r8t-x-x-95">}</span>
  
                                                                                     


